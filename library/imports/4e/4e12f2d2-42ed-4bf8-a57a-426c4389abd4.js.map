{"version":3,"sources":["assets\\scripts\\Game.js"],"names":["cc","Class","Component","properties","starPrefab","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreDisplay","Label","scoreAudio","AudioClip","onLoad","groundY","y","height","timer","starDuration","spawnNewStar","score","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","getComponent","game","Math","random","randX","randY","jumpHeight","maxX","width","v2","update","dt","gameOver","enabled","gainScore","string","audioEngine","playEffect","stopAllActions","director","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        starPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        maxStarDuration: 0,\n        minStarDuration: 0,\n        ground: {\n            default: null,\n            type: cc.Node\n        },\n        player: {\n            default: null,\n            type: cc.Node\n        },\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n        scoreAudio: {\n            default: null,\n            type: cc.AudioClip\n        }\n    },\n\n    onLoad: function () {\n        this.groundY = this.ground.y + this.ground.height / 2;\n        this.timer = 0;\n        this.starDuration = 0;\n        this.spawnNewStar();\n        this.score = 0;\n    },\n\n    spawnNewStar: function () {\n        var newStar = cc.instantiate(this.starPrefab);\n        this.node.addChild(newStar);\n        newStar.setPosition(this.getNewStarPosition());\n        newStar.getComponent('Star').game = this;\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\n        this.timer = 0;\n    },\n\n    getNewStarPosition: function () {\n        var randX = 0;\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 50;\n        var maxX = this.node.width / 2;\n        randX = (Math.random() - 0.5) * 2 * maxX;\n        return cc.v2(randX, randY);\n    },\n\n    update: function (dt) {\n        if (this.timer > this.starDuration) {\n            this.gameOver();\n            this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly\n            return;\n        }\n        this.timer += dt;\n    },\n\n    gainScore: function () {\n        this.score += 1;\n        this.scoreDisplay.string = 'Score: ' + this.score;\n        cc.audioEngine.playEffect(this.scoreAudio, false);\n    },\n\n    gameOver: function () {\n        this.player.stopAllActions();\n        cc.director.loadScene('game');\n    }\n});\n"]}